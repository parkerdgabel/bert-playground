None of PyTorch, TensorFlow >= 2.0, or Flax have been found. Models won't be available and only tokenizers, configuration and file/data utilities can be used.
[32m2025-07-16 13:08:53[0m | [1mINFO    [0m | [36m__main__[0m:[36mmain[0m:[36m143[0m - [1mStarting MLX Optimized Training[0m
[32m2025-07-16 13:08:53[0m | [1mINFO    [0m | [36m__main__[0m:[36mmain[0m:[36m144[0m - [1mArguments: Namespace(data_dir='data/titanic', train_file='train.csv', val_file='val.csv', test_file='test.csv', model_name='answerdotai/ModernBERT-base', config_path=None, epochs=5, base_batch_size=32, max_batch_size=64, eval_batch_size=64, gradient_accumulation_steps=1, learning_rate=2e-05, weight_decay=0.01, warmup_ratio=0.1, num_workers=8, prefetch_size=4, lazy_eval_interval=10, memory_threshold=0.8, output_dir='mlruns', save_steps=100, eval_steps=100, experiment_name='titanic_production', run_name='production_20250716_130848', enable_mlflow=True, seed=42, enable_profiling=False, log_level='INFO')[0m
[32m2025-07-16 13:08:53[0m | [1mINFO    [0m | [36m__main__[0m:[36mmain[0m:[36m153[0m - [1mLoading tokenizer: answerdotai/ModernBERT-base[0m
[32m2025-07-16 13:08:53[0m | [1mINFO    [0m | [36m__main__[0m:[36mmain[0m:[36m157[0m - [1mCreating optimized data loaders...[0m
[32m2025-07-16 13:08:53[0m | [1mINFO    [0m | [36mdata.mlx_enhanced_loader[0m:[36m_load_data[0m:[36m127[0m - [1mLoaded 3564 samples from data/titanic/train.csv[0m
[32m2025-07-16 13:08:53[0m | [1mINFO    [0m | [36mdata.mlx_enhanced_loader[0m:[36m_prepare_cache[0m:[36m144[0m - [1mTokenizing data...[0m
[32m2025-07-16 13:08:53[0m | [1mINFO    [0m | [36mdata.mlx_enhanced_loader[0m:[36m_prepare_cache[0m:[36m150[0m - [1mCached tokenized data to: cache/tokenized/train_128_3564.pkl[0m
[32m2025-07-16 13:08:53[0m | [1mINFO    [0m | [36mdata.mlx_enhanced_loader[0m:[36m__init__[0m:[36m80[0m - [1mInitialized MLX Enhanced Pipeline: samples=3564, batch_size=32, threads=8, prefetch=4, memory_map=True, double_buffer=True[0m
[32m2025-07-16 13:08:53[0m | [1mINFO    [0m | [36mdata.mlx_enhanced_loader[0m:[36m_load_data[0m:[36m127[0m - [1mLoaded 178 samples from data/titanic/val.csv[0m
[32m2025-07-16 13:08:53[0m | [1mINFO    [0m | [36mdata.mlx_enhanced_loader[0m:[36m_prepare_cache[0m:[36m139[0m - [1mLoading tokenized data from cache: cache/tokenized/val_128_178.pkl[0m
[32m2025-07-16 13:08:53[0m | [1mINFO    [0m | [36mdata.mlx_enhanced_loader[0m:[36m__init__[0m:[36m80[0m - [1mInitialized MLX Enhanced Pipeline: samples=178, batch_size=32, threads=4, prefetch=2, memory_map=True, double_buffer=False[0m
[32m2025-07-16 13:08:53[0m | [1mINFO    [0m | [36mdata.mlx_enhanced_loader[0m:[36m_load_data[0m:[36m127[0m - [1mLoaded 891 samples from data/titanic/test.csv[0m
[32m2025-07-16 13:08:53[0m | [1mINFO    [0m | [36mdata.mlx_enhanced_loader[0m:[36m_prepare_cache[0m:[36m139[0m - [1mLoading tokenized data from cache: cache/tokenized/test_128_891.pkl[0m
[32m2025-07-16 13:08:53[0m | [1mINFO    [0m | [36mdata.mlx_enhanced_loader[0m:[36m__init__[0m:[36m80[0m - [1mInitialized MLX Enhanced Pipeline: samples=891, batch_size=32, threads=4, prefetch=2, memory_map=True, double_buffer=False[0m
[32m2025-07-16 13:08:53[0m | [1mINFO    [0m | [36m__main__[0m:[36mmain[0m:[36m174[0m - [1mInitializing CNN-Enhanced ModernBERT model...[0m
[32m2025-07-16 13:08:53[0m | [1mINFO    [0m | [36mmodels.modernbert_cnn_hybrid[0m:[36m__init__[0m:[36m347[0m - [1mInitialized CNN-Enhanced ModernBERT with:
  - 12 transformer layers
  - Multi-scale CNN with kernels: [3, 5, 7]
  - Dilated conv: True
  - Attention fusion: True
  - Highway network: True[0m
[32m2025-07-16 13:08:53[0m | [1mINFO    [0m | [36m__main__[0m:[36mmain[0m:[36m197[0m - [1mModel initialized successfully[0m
[32m2025-07-16 13:08:53[0m | [1mINFO    [0m | [36mtraining.mlx_optimized_trainer[0m:[36m__init__[0m:[36m93[0m - [1mInitialized MLX Optimized Trainer with config: batch_size=32-64, grad_accum=1, workers=8, prefetch=4[0m
[32m2025-07-16 13:08:53[0m | [1mINFO    [0m | [36mutils.mlflow_helper[0m:[36m__init__[0m:[36m86[0m - [1mMLflow tracking URI: file:///Users/parkergabel/PycharmProjects/bert-playground/mlruns/mlruns[0m
[32m2025-07-16 13:08:53[0m | [1mINFO    [0m | [36mutils.mlflow_helper[0m:[36m__init__[0m:[36m87[0m - [1mExperiment: titanic_production (ID: 334660230524672976)[0m
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
huggingface/tokenizers: The current process just got forked, after parallelism has already been used. Disabling parallelism to avoid deadlocks...
To disable this warning, you can either:
	- Avoid using `tokenizers` before the fork if possible
	- Explicitly set the environment variable TOKENIZERS_PARALLELISM=(true | false)
[32m2025-07-16 13:08:53[0m | [1mINFO    [0m | [36mutils.mlflow_helper[0m:[36mstart_run[0m:[36m140[0m - [1mStarted MLflow run: 9f3af905654448f6b994c6b2ac17a508[0m
[32m2025-07-16 13:08:53[0m | [1mINFO    [0m | [36m__main__[0m:[36mmain[0m:[36m261[0m - [1mStarting optimized training...[0m
[32m2025-07-16 13:08:53[0m | [1mINFO    [0m | [36mtraining.mlx_optimized_trainer[0m:[36mtrain[0m:[36m329[0m - [1mStarting optimized training: 5 epochs, 112 steps/epoch, 560 total steps[0m
[32m2025-07-16 13:08:54[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.9178 seconds[0m
[32m2025-07-16 13:08:55[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8526 seconds[0m
[32m2025-07-16 13:08:56[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8151 seconds[0m
[32m2025-07-16 13:08:56[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8082 seconds[0m
[32m2025-07-16 13:08:57[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8042 seconds[0m
[32m2025-07-16 13:08:58[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8071 seconds[0m
[32m2025-07-16 13:08:59[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.7929 seconds[0m
[32m2025-07-16 13:09:00[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.7961 seconds[0m
[32m2025-07-16 13:09:00[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.7952 seconds[0m
[32m2025-07-16 13:09:01[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.7973 seconds[0m
[32m2025-07-16 13:09:02[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.7998 seconds[0m
[32m2025-07-16 13:09:03[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8036 seconds[0m
[32m2025-07-16 13:09:04[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8024 seconds[0m
[32m2025-07-16 13:09:05[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8055 seconds[0m
[32m2025-07-16 13:09:05[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8041 seconds[0m
[32m2025-07-16 13:09:06[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8033 seconds[0m
[32m2025-07-16 13:09:07[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8071 seconds[0m
[32m2025-07-16 13:09:08[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8051 seconds[0m
[32m2025-07-16 13:09:09[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8038 seconds[0m
[32m2025-07-16 13:09:09[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8038 seconds[0m
[32m2025-07-16 13:09:10[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8028 seconds[0m
[32m2025-07-16 13:09:11[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8033 seconds[0m
[32m2025-07-16 13:09:12[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8024 seconds[0m
[32m2025-07-16 13:09:13[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8043 seconds[0m
[32m2025-07-16 13:09:13[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8054 seconds[0m
[32m2025-07-16 13:09:14[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8180 seconds[0m
[32m2025-07-16 13:09:15[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8245 seconds[0m
[32m2025-07-16 13:09:16[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8190 seconds[0m
[32m2025-07-16 13:09:17[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8178 seconds[0m
[32m2025-07-16 13:09:17[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8227 seconds[0m
[32m2025-07-16 13:09:18[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8267 seconds[0m
[32m2025-07-16 13:09:19[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8247 seconds[0m
[32m2025-07-16 13:09:20[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8246 seconds[0m
[32m2025-07-16 13:09:21[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8240 seconds[0m
[32m2025-07-16 13:09:22[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8177 seconds[0m
[32m2025-07-16 13:09:22[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8115 seconds[0m
[32m2025-07-16 13:09:23[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8259 seconds[0m
[32m2025-07-16 13:09:24[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8159 seconds[0m
[32m2025-07-16 13:09:25[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8214 seconds[0m
[32m2025-07-16 13:09:26[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8205 seconds[0m
[32m2025-07-16 13:09:26[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8195 seconds[0m
[32m2025-07-16 13:09:27[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8155 seconds[0m
[32m2025-07-16 13:09:28[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8179 seconds[0m
[32m2025-07-16 13:09:29[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8057 seconds[0m
[32m2025-07-16 13:09:30[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8048 seconds[0m
[32m2025-07-16 13:09:31[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8000 seconds[0m
[32m2025-07-16 13:09:31[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8018 seconds[0m
[32m2025-07-16 13:09:32[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8078 seconds[0m
[32m2025-07-16 13:09:33[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8016 seconds[0m
[32m2025-07-16 13:09:34[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8057 seconds[0m
[32m2025-07-16 13:09:35[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8163 seconds[0m
[32m2025-07-16 13:09:35[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8238 seconds[0m
[32m2025-07-16 13:09:36[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8212 seconds[0m
[32m2025-07-16 13:09:37[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8270 seconds[0m
[32m2025-07-16 13:09:38[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8193 seconds[0m
[32m2025-07-16 13:09:39[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8121 seconds[0m
[32m2025-07-16 13:09:39[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8144 seconds[0m
[32m2025-07-16 13:09:40[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8216 seconds[0m
[32m2025-07-16 13:09:41[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8237 seconds[0m
[32m2025-07-16 13:09:42[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8229 seconds[0m
[32m2025-07-16 13:09:43[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8267 seconds[0m
[32m2025-07-16 13:09:44[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8177 seconds[0m
[32m2025-07-16 13:09:44[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8115 seconds[0m
[32m2025-07-16 13:09:45[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8365 seconds[0m
[32m2025-07-16 13:09:46[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8224 seconds[0m
[32m2025-07-16 13:09:47[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8201 seconds[0m
[32m2025-07-16 13:09:48[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8020 seconds[0m
[32m2025-07-16 13:09:49[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8059 seconds[0m
[32m2025-07-16 13:09:49[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8052 seconds[0m
[32m2025-07-16 13:09:50[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8055 seconds[0m
[32m2025-07-16 13:09:51[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8042 seconds[0m
[32m2025-07-16 13:09:52[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8064 seconds[0m
[32m2025-07-16 13:09:53[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8025 seconds[0m
[32m2025-07-16 13:09:53[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8029 seconds[0m
[32m2025-07-16 13:09:54[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8032 seconds[0m
[32m2025-07-16 13:09:55[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8039 seconds[0m
[32m2025-07-16 13:09:56[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8060 seconds[0m
[32m2025-07-16 13:09:57[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8021 seconds[0m
[32m2025-07-16 13:09:57[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8015 seconds[0m
[32m2025-07-16 13:09:58[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.7974 seconds[0m
[32m2025-07-16 13:09:59[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.7974 seconds[0m
[32m2025-07-16 13:10:00[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.7984 seconds[0m
[32m2025-07-16 13:10:01[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.7959 seconds[0m
[32m2025-07-16 13:10:01[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.7988 seconds[0m
[32m2025-07-16 13:10:02[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.7984 seconds[0m
[32m2025-07-16 13:10:03[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.7999 seconds[0m
[32m2025-07-16 13:10:04[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.7991 seconds[0m
[32m2025-07-16 13:10:05[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.7978 seconds[0m
[32m2025-07-16 13:10:05[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.7982 seconds[0m
[32m2025-07-16 13:10:06[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.7986 seconds[0m
[32m2025-07-16 13:10:07[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.7978 seconds[0m
[32m2025-07-16 13:10:08[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.7990 seconds[0m
[32m2025-07-16 13:10:09[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.7967 seconds[0m
[32m2025-07-16 13:10:09[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8014 seconds[0m
[32m2025-07-16 13:10:10[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8000 seconds[0m
[32m2025-07-16 13:10:11[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8006 seconds[0m
[32m2025-07-16 13:10:12[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.7976 seconds[0m
[32m2025-07-16 13:10:13[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.8009 seconds[0m
[32m2025-07-16 13:10:13[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.7992 seconds[0m
[32m2025-07-16 13:10:14[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mtrain_step_lazy executed in 0.7981 seconds[0m
[32m2025-07-16 13:10:14[0m | [1mINFO    [0m | [36mtraining.mlx_optimized_trainer[0m:[36mevaluate_lazy[0m:[36m237[0m - [1mStarting val evaluation with batch_size=64[0m
/Users/parkergabel/PycharmProjects/bert-playground/.venv/lib/python3.13/site-packages/sklearn/metrics/_classification.py:1706: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, f"{metric.capitalize()} is", result.shape[0])
[32m2025-07-16 13:10:15[0m | [1mINFO    [0m | [36mtraining.mlx_optimized_trainer[0m:[36mevaluate_lazy[0m:[36m308[0m - [1mVal Results - Loss: 0.6413, Acc: 0.6573, F1: 0.0000, AUC: 0.5635[0m
[32m2025-07-16 13:10:15[0m | [1mINFO    [0m | [36mutils.logging_config[0m:[36mwrapper[0m:[36m207[0m - [1mevaluate_lazy executed in 1.1354 seconds[0m
[32m2025-07-16 13:10:16[0m | [1mINFO    [0m | [36mmodels.modernbert_cnn_hybrid[0m:[36msave_pretrained[0m:[36m479[0m - [1mCNN-Enhanced ModernBERT saved to mlruns/best[0m

[32m2025-07-16 13:10:16[0m | [31m[1mERROR   [0m | [36m__main__[0m:[36mmain[0m:[36m276[0m - [31m[1mTraining failed: std::bad_cast[0m
[32m2025-07-16 13:10:16[0m | [1mINFO    [0m | [36mutils.mlflow_helper[0m:[36mend_run[0m:[36m417[0m - [1mEnded MLflow run with status: FINISHED[0m
Traceback (most recent call last):
  File "/Users/parkergabel/PycharmProjects/bert-playground/train_optimized.py", line 299, in <module>
    main()
    ~~~~^^
  File "/Users/parkergabel/PycharmProjects/bert-playground/train_optimized.py", line 263, in main
    trainer.train(
    ~~~~~~~~~~~~~^
        train_dataloader=train_loader,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        val_dataloader=val_loader,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
        test_dataloader=test_loader,
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Users/parkergabel/PycharmProjects/bert-playground/training/mlx_optimized_trainer.py", line 407, in train
    self.save_checkpoint("best")
    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^
  File "/Users/parkergabel/PycharmProjects/bert-playground/training/mlx_optimized_trainer.py", line 454, in save_checkpoint
    mx.save_safetensors(
    ~~~~~~~~~~~~~~~~~~~^
        str(optimizer_path),
        ^^^^^^^^^^^^^^^^^^^^
        {"optimizer": self.optimizer.state},
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
RuntimeError: std::bad_cast
